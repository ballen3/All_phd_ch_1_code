######################################
#
# BUSCO summary figure
# @version 4.0.0
# @since BUSCO 2.0.0
# 
# Copyright (c) 2016-2023, Evgeny Zdobnov (ez@ezlab.org)
# Licensed under the MIT license. See LICENSE.md file.
#
######################################

# Load the required libraries
library(ggplot2)
library("grid")

# !!! CONFIGURE YOUR PLOT HERE !!! 
# Output
my_output <- paste("Research","busco_figure.png",sep="/") 
my_width <- 35
my_height <- 30
my_unit <- "cm"

# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75

# Legend
my_title <- "BUSCO Assessment Results"

# Font
my_family <- "sans"
my_size_ratio <- 1

# !!! SEE YOUR DATA HERE !!! 
# Your data as generated by python, remove or add more
my_species <- c('209', '209', '209', '209', '253', '253', '253', '253', '2', '2', '2', '2', '90', '90', '90', '90', '114', '114', '114', '114', '169', '169', '169', '169', '133', '133', '133', '133', '134', '134', '134', '134', '80', '80', '80', '80', '5', '5', '5', '5', '226', '226', '226', '226', '73', '73', '73', '73', '117', '117', '117', '117', '136', '136', '136', '136', '110', '110', '110', '110', '280', '280', '280', '280', '172', '172', '172', '172', '127', '127', '127', '127', '158', '158', '158', '158', '262', '262', '262', '262', '27', '27', '27', '27', '282', '282', '282', '282', '42', '42', '42', '42', '125', '125', '125', '125', '272', '272', '272', '272', '281', '281', '281', '281', '100', '100', '100', '100', '70', '70', '70', '70', '179', '179', '179', '179', '36', '36', '36', '36', '76', '76', '76', '76', '39', '39', '39', '39', '296', '296', '296', '296', '151', '151', '151', '151', '286', '286', '286', '286', '71', '71', '71', '71', '12', '12', '12', '12', '174', '174', '174', '174', '164', '164', '164', '164', '224', '224', '224', '224', '273', '273', '273', '273', '236', '236', '236', '236', '240', '240', '240', '240', '170', '170', '170', '170', '246', '246', '246', '246', '24', '24', '24', '24', '225', '225', '225', '225', '29', '29', '29', '29', '16', '16', '16', '16', '207', '207', '207', '207', '250', '250', '250', '250', '235', '235', '235', '235', '10', '10', '10', '10', '263', '263', '263', '263', '86', '86', '86', '86', '40', '40', '40', '40', '75', '75', '75', '75', '267', '267', '267', '267', '260', '260', '260', '260', '222', '222', '222', '222', '148', '148', '148', '148', '278', '278', '278', '278', '45', '45', '45', '45', '276', '276', '276', '276', '0', '0', '0', '0', '97', '97', '97', '97', '103', '103', '103', '103', '33', '33', '33', '33', '84', '84', '84', '84', '180', '180', '180', '180', '141', '141', '141', '141', '154', '154', '154', '154', '65', '65', '65', '65', '295', '295', '295', '295', '213', '213', '213', '213', '252', '252', '252', '252', '57', '57', '57', '57', '254', '254', '254', '254', '88', '88', '88', '88', '132', '132', '132', '132', '34', '34', '34', '34', '19', '19', '19', '19', '215', '215', '215', '215', '23', '23', '23', '23', '204', '204', '204', '204', '190', '190', '190', '190', '150', '150', '150', '150', '176', '176', '176', '176', '91', '91', '91', '91', '259', '259', '259', '259', '121', '121', '121', '121', '184', '184', '184', '184', '220', '220', '220', '220', '139', '139', '139', '139', '18', '18', '18', '18', '194', '194', '194', '194', '94', '94', '94', '94', '109', '109', '109', '109', '185', '185', '185', '185', '181', '181', '181', '181', '271', '271', '271', '271', '293', '293', '293', '293', '8', '8', '8', '8', '144', '144', '144', '144', '140', '140', '140', '140', '14', '14', '14', '14', '92', '92', '92', '92', '15', '15', '15', '15', '126', '126', '126', '126', '279', '279', '279', '279', '256', '256', '256', '256', '163', '163', '163', '163', '248', '248', '248', '248', '162', '162', '162', '162', '55', '55', '55', '55', '189', '189', '189', '189', '53', '53', '53', '53', '85', '85', '85', '85', '187', '187', '187', '187', '101', '101', '101', '101', '191', '191', '191', '191', '146', '146', '146', '146', '186', '186', '186', '186', '44', '44', '44', '44', '241', '241', '241', '241', '243', '243', '243', '243', '119', '119', '119', '119', '129', '129', '129', '129', '196', '196', '196', '196', '93', '93', '93', '93', '82', '82', '82', '82', '192', '192', '192', '192', '166', '166', '166', '166', '227', '227', '227', '227', '38', '38', '38', '38', '182', '182', '182', '182', '111', '111', '111', '111', '291', '291', '291', '291', '269', '269', '269', '269', '72', '72', '72', '72', '51', '51', '51', '51', '258', '258', '258', '258', '124', '124', '124', '124', '199', '199', '199', '199', '89', '89', '89', '89', '52', '52', '52', '52', '21', '21', '21', '21', '294', '294', '294', '294', '9', '9', '9', '9', '47', '47', '47', '47', '234', '234', '234', '234', '7', '7', '7', '7', '74', '74', '74', '74', '96', '96', '96', '96', '175', '175', '175', '175', '11', '11', '11', '11', '130', '130', '130', '130', '193', '193', '193', '193', '237', '237', '237', '237', '251', '251', '251', '251', '30', '30', '30', '30', '147', '147', '147', '147', '183', '183', '183', '183', '115', '115', '115', '115', '257', '257', '257', '257', '123', '123', '123', '123', '26', '26', '26', '26', '161', '161', '161', '161', '41', '41', '41', '41', '137', '137', '137', '137', '142', '142', '142', '142', '49', '49', '49', '49', '239', '239', '239', '239', '31', '31', '31', '31', '83', '83', '83', '83', '298', '298', '298', '298', '20', '20', '20', '20', '102', '102', '102', '102', '218', '218', '218', '218', '79', '79', '79', '79', '268', '268', '268', '268', '238', '238', '238', '238', '167', '167', '167', '167', '284', '284', '284', '284', '13', '13', '13', '13', '197', '197', '197', '197', '122', '122', '122', '122', '157', '157', '157', '157', '143', '143', '143', '143', '99', '99', '99', '99', '87', '87', '87', '87', '66', '66', '66', '66', '116', '116', '116', '116', '287', '287', '287', '287', '153', '153', '153', '153', '245', '245', '245', '245', '98', '98', '98', '98', '217', '217', '217', '217', '152', '152', '152', '152', '203', '203', '203', '203', '50', '50', '50', '50', '3', '3', '3', '3', '223', '223', '223', '223', '219', '219', '219', '219', '135', '135', '135', '135', '202', '202', '202', '202', '255', '255', '255', '255', '28', '28', '28', '28', '210', '210', '210', '210', '289', '289', '289', '289', '160', '160', '160', '160', '198', '198', '198', '198', '68', '68', '68', '68', '106', '106', '106', '106', '6', '6', '6', '6', '188', '188', '188', '188', '275', '275', '275', '275', '285', '285', '285', '285', '128', '128', '128', '128', '35', '35', '35', '35', '46', '46', '46', '46', '63', '63', '63', '63', '230', '230', '230', '230', '120', '120', '120', '120', '292', '292', '292', '292', '37', '37', '37', '37', '138', '138', '138', '138', '67', '67', '67', '67', '43', '43', '43', '43', '25', '25', '25', '25', '131', '131', '131', '131', '156', '156', '156', '156', '17', '17', '17', '17', '165', '165', '165', '165', '32', '32', '32', '32', '149', '149', '149', '149', '216', '216', '216', '216', '233', '233', '233', '233', '201', '201', '201', '201', '78', '78', '78', '78', '4', '4', '4', '4', '159', '159', '159', '159', '22', '22', '22', '22', '118', '118', '118', '118', '270', '270', '270', '270', '206', '206', '206', '206', '205', '205', '205', '205', '105', '105', '105', '105', '77', '77', '77', '77')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(51.6, 1.0, 12.4, 35.0, 52.5, 0.7, 12.8, 34.0, 47.0, 0.4, 13.0, 39.6, 63.3, 1.0, 10.2, 25.5, 52.6, 1.0, 12.2, 34.2, 93.9, 0.9, 0.9, 4.3, 60.5, 1.2, 10.8, 27.5, 56.3, 0.9, 11.3, 31.5, 66.4, 1.4, 10.2, 22.0, 65.8, 0.4, 9.5, 24.3, 58.1, 0.9, 10.6, 30.4, 62.2, 1.0, 11.0, 25.8, 63.0, 1.4, 10.6, 25.0, 55.8, 1.0, 12.4, 30.8, 93.8, 1.1, 0.8, 4.3, 52.4, 0.7, 12.0, 34.9, 54.6, 1.0, 11.3, 33.1, 69.1, 0.8, 8.3, 21.8, 64.9, 1.3, 9.7, 24.1, 52.3, 0.8, 12.7, 34.2, 48.4, 0.4, 12.1, 39.1, 54.1, 1.0, 11.6, 33.3, 93.5, 0.7, 1.1, 4.7, 61.9, 1.0, 9.9, 27.2, 60.6, 0.9, 9.6, 28.9, 50.8, 1.0, 12.8, 35.4, 64.3, 1.4, 9.9, 24.4, 62.0, 1.2, 10.5, 26.3, 49.3, 1.0, 13.8, 35.9, 92.9, 0.7, 1.2, 5.2, 61.6, 1.1, 10.5, 26.8, 46.5, 0.6, 12.3, 40.6, 51.0, 0.8, 12.3, 35.9, 69.4, 1.0, 8.5, 21.1, 55.4, 1.1, 11.6, 31.9, 64.7, 1.5, 10.4, 23.4, 45.4, 0.4, 12.0, 42.2, 55.0, 0.8, 12.5, 31.7, 56.4, 0.7, 11.2, 31.7, 59.8, 1.4, 10.5, 28.3, 51.9, 1.3, 12.7, 34.1, 51.9, 0.9, 12.3, 34.9, 55.5, 0.9, 11.5, 32.1, 63.2, 1.0, 11.4, 24.4, 52.2, 0.8, 12.4, 34.6, 44.6, 0.2, 11.0, 44.2, 92.8, 0.9, 1.2, 5.1, 44.4, 0.5, 11.5, 43.6, 93.3, 1.0, 0.9, 4.8, 62.3, 1.5, 11.7, 24.5, 55.4, 1.1, 12.9, 30.6, 56.9, 0.9, 10.9, 31.3, 43.1, 0.5, 11.4, 45.0, 60.5, 1.1, 11.2, 27.2, 64.0, 1.2, 10.6, 24.2, 92.8, 0.8, 1.1, 5.3, 62.6, 1.1, 10.8, 25.5, 52.3, 1.0, 12.7, 34.0, 54.2, 1.0, 11.8, 33.0, 93.1, 1.0, 1.1, 4.8, 61.3, 1.1, 11.3, 26.3, 52.5, 0.9, 12.0, 34.6, 67.9, 0.5, 9.0, 22.6, 55.2, 1.0, 11.1, 32.7, 93.5, 0.9, 1.1, 4.5, 71.3, 1.3, 8.3, 19.1, 58.6, 1.1, 11.8, 28.5, 52.6, 0.4, 11.7, 35.3, 63.5, 1.3, 10.6, 24.6, 93.7, 1.1, 0.8, 4.4, 60.8, 1.0, 11.3, 26.9, 60.4, 1.0, 10.7, 27.9, 61.0, 1.2, 11.1, 26.7, 61.2, 0.8, 10.5, 27.5, 81.4, 0.8, 4.3, 13.5, 70.1, 0.8, 8.8, 20.3, 52.8, 0.5, 12.6, 34.1, 47.2, 1.1, 13.3, 38.4, 63.9, 1.1, 10.7, 24.3, 67.3, 1.1, 8.9, 22.7, 51.9, 0.5, 11.6, 36.0, 46.3, 0.5, 11.7, 41.5, 55.6, 1.1, 12.3, 31.0, 52.1, 0.4, 10.5, 37.0, 51.4, 0.9, 12.2, 35.5, 80.4, 1.3, 6.1, 12.2, 62.2, 1.1, 10.0, 26.7, 59.4, 1.4, 11.9, 27.3, 62.8, 1.5, 10.4, 25.3, 66.5, 0.8, 9.3, 23.4, 61.7, 1.1, 10.4, 26.8, 92.7, 0.9, 1.3, 5.1, 56.3, 0.7, 10.2, 32.8, 58.2, 1.0, 11.7, 29.1, 48.6, 0.6, 13.0, 37.8, 76.4, 1.0, 6.9, 15.7, 62.8, 1.2, 10.7, 25.3, 93.9, 1.0, 0.8, 4.3, 53.2, 1.1, 11.9, 33.8, 52.6, 0.8, 13.0, 33.6, 55.5, 0.8, 10.9, 32.8, 57.8, 0.8, 10.4, 31.0, 48.7, 0.5, 11.5, 39.3, 67.8, 0.9, 8.2, 23.1, 62.7, 0.9, 10.5, 25.9, 93.6, 0.9, 0.9, 4.6, 62.4, 1.1, 10.2, 26.3, 46.1, 0.5, 12.4, 41.0, 65.0, 1.2, 10.0, 23.8, 93.0, 1.0, 1.0, 5.0, 93.6, 0.8, 1.0, 4.6, 56.6, 0.6, 11.4, 31.4, 88.4, 0.6, 2.9, 8.1, 57.8, 1.3, 10.8, 30.1, 45.0, 0.6, 12.7, 41.7, 60.0, 1.5, 12.1, 26.4, 93.8, 0.9, 0.8, 4.5, 64.3, 1.5, 10.6, 23.6, 57.5, 1.1, 10.8, 30.6, 67.5, 1.5, 9.6, 21.4, 55.3, 0.8, 12.3, 31.6, 61.7, 1.3, 10.1, 26.9, 62.6, 1.2, 11.6, 24.6, 92.9, 0.7, 1.2, 5.2, 63.5, 1.5, 10.1, 24.9, 65.9, 0.7, 10.6, 22.8, 56.8, 1.1, 10.8, 31.3, 66.0, 1.2, 8.5, 24.3, 62.9, 1.5, 11.0, 24.6, 65.4, 1.4, 10.0, 23.2, 65.0, 0.7, 9.7, 24.6, 94.3, 1.0, 0.6, 4.1, 58.7, 0.9, 11.2, 29.2, 58.8, 0.8, 10.4, 30.0, 93.4, 0.7, 1.1, 4.8, 54.2, 0.7, 10.9, 34.2, 93.9, 0.9, 0.7, 4.5, 58.2, 0.9, 11.4, 29.5, 49.5, 1.2, 12.9, 36.4, 66.9, 1.3, 9.0, 22.8, 49.0, 0.5, 12.1, 38.4, 53.2, 0.9, 11.8, 34.1, 66.0, 1.1, 9.1, 23.8, 51.3, 0.8, 12.3, 35.6, 67.6, 1.2, 9.0, 22.2, 63.3, 0.4, 9.5, 26.8, 93.6, 0.9, 0.9, 4.6, 56.8, 0.9, 11.3, 31.0, 93.2, 0.7, 1.0, 5.1, 46.1, 0.5, 11.7, 41.7, 55.7, 1.3, 10.7, 32.3, 48.4, 0.6, 11.6, 39.4, 60.4, 1.3, 11.5, 26.8, 58.7, 1.3, 12.0, 28.0, 93.7, 1.1, 0.8, 4.4, 92.5, 1.7, 1.0, 4.8, 67.9, 1.2, 9.1, 21.8, 75.7, 1.2, 6.7, 16.4, 51.1, 1.0, 12.9, 35.0, 93.9, 0.8, 0.9, 4.4, 50.6, 0.6, 11.7, 37.1, 67.9, 1.5, 8.6, 22.0, 67.4, 0.8, 7.4, 24.4, 58.1, 1.1, 11.5, 29.3, 52.5, 1.0, 11.5, 35.0, 64.5, 1.3, 10.3, 23.9, 93.7, 0.8, 0.9, 4.6, 59.0, 1.4, 11.1, 28.5, 44.8, 0.5, 11.3, 43.4, 62.1, 1.4, 11.5, 25.0, 73.2, 1.0, 6.0, 19.8, 50.0, 0.6, 11.0, 38.4, 47.1, 0.8, 13.2, 38.9, 93.7, 1.1, 0.8, 4.4, 63.4, 1.4, 10.0, 25.2, 53.8, 0.8, 11.8, 33.6, 93.6, 0.8, 1.0, 4.6, 63.9, 1.2, 10.5, 24.4, 92.4, 1.0, 1.6, 5.0, 64.0, 1.4, 10.4, 24.2, 50.6, 1.2, 12.9, 35.3, 50.3, 1.0, 12.8, 35.9, 52.6, 0.7, 13.5, 33.2, 54.7, 0.7, 11.6, 33.0, 93.8, 0.9, 0.8, 4.5, 50.1, 1.1, 11.9, 36.9, 54.0, 0.9, 11.2, 33.9, 59.6, 1.2, 10.9, 28.3, 69.8, 1.3, 8.6, 20.3, 67.4, 1.2, 10.2, 21.2, 68.7, 1.1, 9.6, 20.6, 64.5, 1.5, 9.7, 24.3, 77.6, 0.9, 5.1, 16.4, 56.2, 1.1, 11.0, 31.7, 61.2, 1.1, 11.1, 26.6, 51.1, 0.8, 12.3, 35.8, 65.8, 1.2, 9.7, 23.3, 52.1, 0.9, 11.7, 35.3, 56.2, 1.1, 11.1, 31.6, 55.5, 1.0, 12.4, 31.1, 93.1, 0.8, 1.0, 5.1, 44.3, 0.5, 11.0, 44.2, 77.8, 0.7, 6.5, 15.0, 59.2, 0.6, 10.4, 29.8, 58.2, 1.2, 12.0, 28.6, 60.5, 1.5, 11.6, 26.4, 93.8, 1.1, 0.8, 4.3, 93.6, 0.7, 1.0, 4.7, 55.2, 1.2, 11.6, 32.0, 56.2, 1.0, 10.8, 32.0, 62.6, 1.1, 11.0, 25.3, 92.8, 0.8, 1.3, 5.1, 65.6, 1.4, 10.1, 22.9, 93.6, 1.4, 0.7, 4.3, 93.1, 0.7, 1.2, 5.0, 83.5, 1.2, 4.8, 10.5, 55.4, 1.0, 11.7, 31.9, 49.7, 1.0, 12.7, 36.6, 70.5, 1.2, 8.0, 20.3, 94.0, 0.9, 0.7, 4.4, 47.6, 0.3, 11.6, 40.5, 53.9, 0.5, 10.8, 34.8, 57.0, 0.7, 10.9, 31.4, 50.9, 1.2, 12.3, 35.6, 53.6, 1.1, 12.2, 33.1, 51.6, 0.4, 10.7, 37.3, 54.5, 1.1, 11.0, 33.4, 67.3, 1.1, 9.8, 21.8, 93.2, 0.8, 1.1, 4.9, 50.6, 0.6, 11.2, 37.6, 61.6, 1.3, 9.7, 27.4, 61.6, 1.1, 10.6, 26.7, 43.6, 0.5, 12.0, 43.9, 88.6, 0.7, 3.3, 7.4, 47.7, 0.4, 11.8, 40.1, 62.5, 1.5, 10.2, 25.8, 54.7, 0.6, 11.8, 32.9, 58.8, 0.9, 9.8, 30.5, 92.7, 0.9, 1.4, 5.0, 64.3, 1.3, 9.9, 24.5, 50.8, 0.5, 11.8, 36.9, 54.6, 1.1, 11.5, 32.8, 94.0, 0.7, 0.9, 4.4, 54.3, 1.0, 12.1, 32.6, 57.8, 1.3, 11.4, 29.5, 57.8, 1.0, 10.8, 30.4, 64.7, 1.6, 10.3, 23.4, 93.6, 1.1, 0.9, 4.4, 64.8, 1.2, 9.8, 24.2)
my_values <- c(2516, 49, 607, 1706, 2562, 36, 622, 1658, 2293, 21, 634, 1930, 3088, 51, 496, 1243, 2566, 49, 595, 1668, 4580, 46, 42, 210, 2949, 57, 527, 1345, 2747, 43, 552, 1536, 3239, 66, 498, 1075, 3212, 20, 464, 1182, 2836, 43, 519, 1480, 3033, 50, 536, 1259, 3071, 67, 516, 1224, 2723, 51, 607, 1497, 4574, 53, 40, 211, 2558, 33, 586, 1701, 2661, 48, 550, 1619, 3372, 40, 405, 1061, 3165, 64, 474, 1175, 2551, 37, 621, 1669, 2361, 18, 592, 1907, 2637, 48, 565, 1628, 4562, 32, 52, 232, 3021, 47, 485, 1325, 2956, 45, 468, 1409, 2480, 49, 623, 1726, 3135, 68, 484, 1191, 3022, 57, 511, 1288, 2407, 48, 674, 1749, 4531, 33, 57, 257, 3007, 56, 514, 1301, 2270, 28, 601, 1979, 2488, 40, 601, 1749, 3383, 50, 414, 1031, 2700, 54, 566, 1558, 3154, 75, 508, 1141, 2216, 19, 586, 2057, 2685, 41, 612, 1540, 2751, 34, 547, 1546, 2916, 69, 511, 1382, 2532, 64, 619, 1663, 2534, 44, 602, 1698, 2708, 44, 563, 1563, 3083, 51, 555, 1189, 2548, 41, 606, 1683, 2175, 11, 537, 2155, 4529, 44, 57, 248, 2168, 22, 559, 2129, 4553, 49, 46, 230, 3037, 72, 569, 1200, 2701, 53, 629, 1495, 2775, 43, 532, 1528, 2101, 24, 557, 2196, 2953, 56, 545, 1324, 3122, 59, 518, 1179, 4529, 40, 54, 255, 3053, 55, 528, 1242, 2552, 49, 618, 1659, 2644, 51, 575, 1608, 4541, 47, 54, 236, 2989, 52, 553, 1284, 2562, 44, 583, 1689, 3310, 23, 439, 1106, 2691, 50, 540, 1597, 4559, 44, 52, 223, 3477, 64, 406, 931, 2859, 53, 575, 1391, 2564, 19, 572, 1723, 3096, 61, 517, 1204, 4569, 53, 39, 217, 2966, 49, 552, 1311, 2948, 51, 520, 1359, 2976, 59, 542, 1301, 2986, 39, 513, 1340, 3970, 39, 208, 661, 3421, 38, 431, 988, 2576, 22, 613, 1667, 2304, 53, 648, 1873, 3115, 55, 524, 1184, 3282, 52, 435, 1109, 2530, 22, 565, 1761, 2260, 25, 570, 2023, 2711, 52, 602, 1513, 2539, 20, 511, 1808, 2509, 44, 595, 1730, 3922, 65, 296, 595, 3033, 55, 487, 1303, 2898, 70, 579, 1331, 3062, 72, 507, 1237, 3246, 39, 456, 1137, 3011, 54, 508, 1305, 4521, 44, 63, 250, 2745, 33, 498, 1602, 2838, 51, 570, 1419, 2371, 30, 636, 1841, 3726, 51, 337, 764, 3063, 60, 520, 1235, 4580, 48, 41, 209, 2595, 55, 580, 1648, 2565, 37, 633, 1643, 2708, 41, 534, 1595, 2820, 37, 506, 1515, 2375, 23, 562, 1918, 3309, 45, 400, 1124, 3057, 44, 512, 1265, 4566, 43, 43, 226, 3044, 55, 499, 1280, 2249, 24, 607, 1998, 3172, 60, 488, 1158, 4537, 49, 47, 245, 4564, 40, 49, 225, 2761, 28, 554, 1535, 4314, 31, 143, 390, 2819, 61, 528, 1470, 2196, 29, 621, 2032, 2927, 71, 592, 1288, 4576, 42, 40, 220, 3135, 71, 515, 1157, 2805, 52, 529, 1492, 3292, 71, 468, 1047, 2697, 37, 599, 1545, 3008, 63, 495, 1312, 3052, 58, 567, 1201, 4534, 32, 57, 255, 3098, 73, 495, 1212, 3214, 34, 517, 1113, 2770, 56, 528, 1524, 3218, 59, 415, 1186, 3070, 72, 536, 1200, 3192, 70, 487, 1129, 3170, 36, 473, 1199, 4598, 48, 30, 202, 2863, 44, 545, 1426, 2869, 38, 508, 1463, 4554, 32, 55, 237, 2642, 32, 530, 1674, 4581, 46, 36, 215, 2839, 45, 558, 1436, 2415, 57, 628, 1778, 3264, 64, 441, 1109, 2390, 22, 589, 1877, 2596, 45, 575, 1662, 3218, 55, 444, 1161, 2502, 41, 602, 1733, 3299, 60, 437, 1082, 3086, 18, 464, 1310, 4564, 43, 46, 225, 2770, 44, 551, 1513, 4548, 34, 49, 247, 2248, 26, 571, 2033, 2719, 65, 522, 1572, 2361, 29, 565, 1923, 2945, 64, 559, 1310, 2861, 61, 587, 1369, 4571, 52, 40, 215, 4513, 83, 47, 235, 3312, 59, 443, 1064, 3695, 60, 328, 795, 2495, 50, 628, 1705, 4579, 38, 44, 217, 2467, 29, 570, 1812, 3311, 71, 418, 1078, 3286, 39, 363, 1190, 2836, 53, 563, 1426, 2562, 49, 562, 1705, 3147, 61, 504, 1166, 4569, 41, 42, 226, 2878, 68, 541, 1391, 2183, 23, 552, 2120, 3028, 67, 562, 1221, 3571, 50, 293, 964, 2437, 27, 539, 1875, 2297, 39, 645, 1897, 4572, 56, 39, 211, 3092, 69, 487, 1230, 2625, 41, 578, 1634, 4568, 40, 51, 219, 3119, 58, 512, 1189, 4505, 49, 79, 245, 3124, 69, 505, 1180, 2468, 57, 631, 1722, 2453, 48, 624, 1753, 2564, 33, 659, 1622, 2667, 32, 565, 1614, 4578, 44, 38, 218, 2445, 55, 581, 1797, 2634, 46, 546, 1652, 2905, 58, 534, 1381, 3405, 63, 421, 989, 3286, 59, 498, 1035, 3349, 55, 466, 1008, 3146, 72, 472, 1188, 3784, 44, 247, 803, 2740, 52, 538, 1548, 2983, 56, 541, 1298, 2492, 37, 598, 1751, 3209, 60, 473, 1136, 2542, 44, 572, 1720, 2739, 52, 541, 1546, 2705, 49, 603, 1521, 4541, 38, 51, 248, 2159, 23, 536, 2160, 3793, 32, 319, 734, 2887, 29, 505, 1457, 2840, 57, 583, 1398, 2951, 71, 566, 1290, 4575, 53, 41, 209, 4565, 33, 47, 233, 2692, 59, 566, 1561, 2741, 51, 529, 1557, 3054, 52, 538, 1234, 4526, 41, 62, 249, 3199, 67, 492, 1120, 4564, 67, 36, 211, 4542, 36, 57, 243, 4073, 58, 234, 513, 2703, 50, 569, 1556, 2424, 51, 620, 1783, 3441, 57, 391, 989, 4587, 43, 34, 214, 2324, 17, 567, 1970, 2631, 23, 526, 1698, 2779, 34, 530, 1535, 2482, 57, 599, 1740, 2613, 53, 597, 1615, 2518, 21, 524, 1815, 2660, 53, 536, 1629, 3281, 52, 479, 1066, 4547, 39, 56, 236, 2468, 27, 545, 1838, 3005, 65, 475, 1333, 3006, 53, 519, 1300, 2126, 22, 587, 2143, 4324, 34, 159, 361, 2326, 21, 576, 1955, 3049, 75, 498, 1256, 2667, 29, 576, 1606, 2868, 45, 476, 1489, 4520, 42, 69, 247, 3138, 64, 482, 1194, 2480, 26, 576, 1796, 2662, 56, 562, 1598, 4586, 36, 45, 211, 2647, 50, 589, 1592, 2821, 61, 557, 1439, 2820, 49, 528, 1481, 3156, 76, 504, 1142, 4564, 54, 42, 218, 3159, 59, 480, 1180)

######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
 labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)

figure <- ggplot() + 
  
  geom_bar(aes(y = my_percentage, x = my_species, fill = category), position = position_stack(reverse = TRUE), data = df, stat="identity", width=my_bar_height) + 
  coord_flip() + 
  theme_gray(base_size = 8) + 
  scale_y_continuous(labels = c("0","20","40","60","80","100"), breaks = c(0,20,40,60,80,100)) + 
  scale_fill_manual(values = my_colors,labels =c(" Complete (C) and single-copy (S)  ",
                                                 " Complete (C) and duplicated (D)",
                                                 " Fragmented (F)  ",
                                                 " Missing (M)")) +   
  ggtitle(my_title) + 
  xlab("") + 
  ylab("\n%BUSCOs") + 

  theme(plot.title = element_text(family=my_family, hjust=0.5, colour = "black", size = rel(2.2)*my_size_ratio, face = "bold")) + 
  theme(legend.position="top",legend.title = element_blank()) + 
  theme(legend.text = element_text(family=my_family, size = rel(1.2)*my_size_ratio)) + 
  theme(panel.background = element_rect(color="#FFFFFF", fill="white")) + 
  theme(panel.grid.minor = element_blank()) + 
  theme(panel.grid.major = element_blank()) +
  theme(axis.text.y = element_text(family=my_family, colour = "black", size = rel(1.66)*my_size_ratio)) + 
  theme(axis.text.x = element_text(family=my_family, colour = "black", size = rel(1.66)*my_size_ratio)) + 
  theme(axis.line = element_line(size=1*my_size_ratio, colour = "black")) + 
  theme(axis.ticks.length = unit(.85, "cm")) + 
  theme(axis.ticks.y = element_line(colour="white", size = 0)) + 
  theme(axis.ticks.x = element_line(colour="#222222")) + 
  theme(axis.ticks.length = unit(0.4, "cm")) + 
  theme(axis.title.x = element_text(family=my_family, size=rel(1.2)*my_size_ratio)) + 
  
  guides(fill = guide_legend(override.aes = list(colour = NULL))) +
  guides(fill=guide_legend(nrow=2,byrow=TRUE))
  
  for(i in rev(c(1:length(levels(my_species))))){
    detailed_values <- my_values[my_species==my_species[my_species==levels(my_species)[i]]]
    total_buscos <- sum(detailed_values)
    figure <- figure + 
    annotate("text", label=paste("C:", detailed_values[1] + detailed_values[2], " [S:", detailed_values[1], ", D:", detailed_values[2], "], F:", detailed_values[3], ", M:", detailed_values[4], ", n:", total_buscos, sep=""), 
             y=3, x = i, size = labsize*4*my_size_ratio, colour = "black", hjust=0, family=my_family)
  }

library(svglite)  
ggsave("Research/busco_fig.png", figure, width = my_width, height = my_height, unit = my_unit)
print("Done")
figure
